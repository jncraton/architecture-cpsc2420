Lab questions?

9 Memory and Storage
====================

CPUs
----

- Execute instructions
- Have access to a limited number of registers to store data

Memory
------

- Used to store programs and data
- Any solid-state device that provides storage

Technology
----------

- Architects may select from a host of available technologies to store data
- Examples include DRAM and flash memories

---

![Core Memory](https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/KL_CoreMemory.jpg/600px-KL_CoreMemory.jpg)

Organization
------------

- Regardless of technology chosen, architects also determine how memory should be organized
- Organization determines how the technology is put together to form a working system

Memory Characteristics
----------------------

- Volatile or nonvolatile
- Random or sequential
- Read-write or read-only
- Primary or secondary

Volatile
--------

- Memory contents disappear without power
- Main memory is typically volatile

Non-volatile
------------

- Memory contents persist without power
- Long term data storage is frequently non-volatile

Memory Access
-------------

- **Random access** allows any value to be accessed at any time
- **Sequential access** reads values in the order they were inserted (FIFO)
- A tape drive is an example of a sequential access memory

---

![30 TB* tape cartridge](media/tape.png)

---

![Tape library for nearline storage](https://upload.wikimedia.org/wikipedia/commons/thumb/c/c9/StorageTek_Powderhorn_tape_library.jpg/360px-StorageTek_Powderhorn_tape_library.jpg)

Permanence
----------

- Some memories allow values to be updated, others do not
- Read-only Memory (ROM) can only be read
- Some memories are erasable, but can't be updated randomly

---

![UV erasable EPROM](https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/ST_Microelectronics_M27C256B_%282006%29.jpg/348px-ST_Microelectronics_M27C256B_%282006%29.jpg)

Memory Hiearchy
---------------

- Economic factors lead systems to include multiple memories
- Faster memories are usually more expensive
- Larger memories are usually more expensive
- Speed and size are both ultimately limited by physics

---

![Memory Hierarchy](https://upload.wikimedia.org/wikipedia/commons/0/0c/ComputerMemoryHierarchy.svg){height=540px}

---

![CPU Memories](https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Separate_unified.png/380px-Separate_unified.png)

Instruction and Data Memory
---------------------------

- Instructions and data are generally stored together (Von Neumann architecture)
- They may sometimes be separated for performance or architecture reasons, such as storing initial instructions in ROM and caching instructions and data separately

Fetch and Store
---------------

- Memories support 2 basic operations
- Fetch - read a value from memory
- Store - write a value to memory

10 Physical Memory and Addressing
=================================

Random Access Memory
--------------------

- Most memory used by running programs is random access
- Programs can read and write arbitrary data values

Static RAM
----------

- Extension of digital logic
- Gates are combined to form latches (also called flip-flops)
- Latches can be used to store data for later use

---

![SR latch using NOR gates](https://upload.wikimedia.org/wikipedia/commons/5/53/RS_Flip-flop_%28NOR%29.svg){height=540px}

---

![SR latch using transistors](https://upload.wikimedia.org/wikipedia/commons/a/a5/Transistor_Bistable_interactive_animated-en.svg)

SRAM Usage
----------

- SRAM is fast
- SRAM uses many transistors that must be powered so it consumes power and generates heat
- SRAM is typically only used where speed is critical

Dynamic RAM
-----------

- Store charge in a capacitor to represent a high value
- Read capacitor state to determine bit value
- Capacitors hold their charge without power, so are more efficient than SRAM designs

Capacitors
----------

- Store electric charge
- When a voltage is applied, a charge gathers
- Charge slowly discharges over time

Refresh
-------

- Charge is lost over time
- A circuit is needed to frequently refresh the charge
- A refresh reads the current value and stores it again at the proper level of charge
- Refreshes typically happen every 64ms or more

Density
-------

- Memory cells per square area
- Memory density has historically doubled every 18 months following Moore's law

Bandwidth
---------

- Bytes written per time
- Bytes read per time
- Read and write speed may be drastically different

Latency
-------

- Time required to execute a memory operation
- Memories may be high bandwidth and high latency

Memory Access
-------------

- Memory data is transmitted over the memory bus
- Memory locations are addressed using an index into an array of memory words
- Word size may vary by system

---

Address
------- -----------
0       32-bit word
1       32-bit word
2       32-bit word
3       32-bit word
4       32-bit word
5       32-bit word
6       32-bit word

Operations
----------

- Read - gets data from a memory address
- Write - stored data to a memory address

Byte addressing
---------------

- Programmers often want to access specific bytes
- A memory controller can hand retrieving the appropriate word from memory and then the correct byte from the word

----

Word     Byte
-------  ---- ---- ---- ----
0        0    1    2    3
1        4    5    6    7
2        8    9    10   11
3        12   13   14   15

Powers of Two
-------------

- Modular arithmetic needed to convert from byte to word addresses is generally expensive
- It becomes very cheap if we use powers of two

Alignment
---------

- It is expensive to request a word-sized value that does not begin on a word boundary
- We say that this value is not aligned
- On many architectures this will not be allowed or will come at a significant performance cost

Address Space
-------------

- We can only access as much memory as we have addresses
- For 32-bit addresses, this is 2^32 words
- Addresses often need to be stored themselves, so longer addresses than needed have a storage cost
